# AutoScan 安裝使用手冊

> 📘 **本手冊專為不熟悉程式語言的使用者設計，將以最簡單的方式帶您完成安裝與設定。**

---

## 📋 目錄

1. [安裝前準備](#1-安裝前準備)
2. [下載與解壓縮程式](#2-下載與解壓縮程式)
3. [安裝必要軟體](#3-安裝必要軟體)
4. [設定 API 金鑰](#4-設定-api-金鑰)
5. [啟動程式](#5-啟動程式)
6. [開始使用](#6-開始使用)
7. [常見問題排解](#7-常見問題排解)

---

## 1. 安裝前準備

### 📝 需要準備的資料

在開始安裝前，您需要準備以下資訊：

| 項目                   | 取得方式                                                     | 必要性  |
| ---------------------- | ------------------------------------------------------------ | ------- |
| **Gemini API Key**     | [Google AI Studio](https://aistudio.google.com/app/apikey)   | ✅ 必要 |
| **OpenAI API Key**     | [OpenAI Platform](https://platform.openai.com/api-keys)      | ⚠️ 可選 |
| **Notion Token**       | [Notion Integrations](https://www.notion.so/my-integrations) | ✅ 必要 |
| **Notion Database ID** | 從 Notion 資料庫網址取得                                     | ✅ 必要 |

> [!TIP]
> 建議先準備好所有資料再開始安裝，這樣可以一次完成所有設定。

---

## 2. 下載與解壓縮程式

### 步驟 2.1：從 GitHub 下載程式

1. 開啟瀏覽器，前往：

   ```
   https://github.com/您的帳號/AutoScan
   ```

2. 點擊綠色的 **「Code」** 按鈕

3. 選擇 **「Download ZIP」**

4. 將下載的 ZIP 檔案儲存到您的電腦（建議放在「文件」資料夾）

### 步驟 2.2：解壓縮檔案

1. 找到下載的 `AutoScan-main.zip` 檔案

2. 在檔案上按右鍵，選擇 **「解壓縮全部」**

3. 選擇解壓縮位置（例如：`C:\Users\您的使用者名稱\Documents\AutoScan`）

4. 完成後會看到一個名為 `AutoScan` 的資料夾

---

## 3. 安裝必要軟體

### 步驟 3.1：安裝 Node.js

> [!IMPORTANT]
> Node.js 是 AutoScan 運行所需的基礎軟體，必須先安裝。

1. **下載 Node.js：**

   - 前往：https://nodejs.org/
   - 下載 **LTS 版本**（左邊的按鈕，推薦大多數使用者使用）
   - 檔案名稱類似：`node-v20.x.x-x64.msi`

2. **安裝 Node.js：**

   - 雙擊下載的安裝檔
   - 一路點選 **「Next」**（下一步）
   - 保持預設設定即可
   - 最後點選 **「Install」**（安裝）
   - 安裝完成後點選 **「Finish」**（完成）

3. **驗證安裝：**
   - 按下鍵盤 **`Windows + R`**
   - 輸入 `cmd` 後按 Enter
   - 在黑色視窗中輸入：
     ```
     node --version
     ```
   - 如果顯示版本號（例如：`v20.11.0`），表示安裝成功 ✅

### 步驟 3.2：安裝程式相依套件

1. **開啟命令提示字元：**

   - 按下鍵盤 **`Windows + R`**
   - 輸入 `cmd` 後按 Enter

2. **進入程式資料夾：**

   ```
   cd C:\Users\您的使用者名稱\Documents\AutoScan
   ```

   > [!TIP]
   > 可以直接在檔案總管中開啟 AutoScan 資料夾，然後在網址列輸入 `cmd` 並按 Enter，會自動在該資料夾開啟命令提示字元。

3. **安裝相依套件：**

   ```
   npm install
   ```

   > ⏳ 這個步驟需要幾分鐘時間，請耐心等待。安裝完成後會看到類似以下訊息：

   ```
   added 50 packages in 30s
   ```

---

## 4. 設定 API 金鑰

這是最重要的步驟！您需要將準備好的 API 金鑰填入配置檔案。

### 步驟 4.1：取得 Gemini API Key

1. **前往 Google AI Studio：**

   - 開啟瀏覽器，前往：https://aistudio.google.com/app/apikey
   - 使用您的 Google 帳號登入

2. **創建 API Key：**

   - 點擊 **「Create API key」**（建立 API 金鑰）
   - 選擇或創建一個 Google Cloud 專案
   - 複製生成的 API Key（格式：`AIzaSy...`）

   > [!CAUTION]
   > API Key 很重要，請妥善保管，不要分享給他人！

3. **儲存 API Key：**
   - 建議先複製到記事本（後續設定會用到）

### 步驟 4.2：取得 OpenAI API Key（可選）

> [!NOTE]
> 如果您只想使用 Gemini，可以跳過此步驟。

1. **前往 OpenAI Platform：**

   - 開啟瀏覽器，前往：https://platform.openai.com/api-keys
   - 登入您的 OpenAI 帳號（需要先註冊）

2. **創建 API Key：**

   - 點擊 **「Create new secret key」**
   - 輸入名稱（例如：`AutoScan`）
   - 複製生成的 API Key（格式：`sk-proj-...`）

3. **儲存 API Key：**
   - 複製到記事本備用

### 步驟 4.3：取得 Notion 設定

#### A. 創建 Notion Integration

1. **前往 Notion Integrations：**

   - 開啟瀏覽器，前往：https://www.notion.so/my-integrations
   - 點擊 **「New integration」**（新增整合）

2. **設定 Integration：**

   - **Name（名稱）**：輸入 `AutoScan`
   - **Associated workspace**：選擇您的工作區
   - 點擊 **「Submit」**（提交）

3. **複製 Token：**
   - 在 **「Internal Integration Token」** 區域
   - 點擊 **「Show」** 然後複製 Token（格式：`secret_...` 或 `ntn_...`）
   - 儲存到記事本

#### B. 取得 Database ID

1. **開啟您的 Notion 資料庫：**

   - 在瀏覽器中開啟要使用的 Notion 資料庫頁面

2. **從網址取得 Database ID：**

   網址格式：

   ```
   https://www.notion.so/您的工作區名稱/資料庫ID?v=...
   ```

   例如：

   ```
   https://www.notion.so/myworkspace/2e62059200d88010830efb67104f032e?v=...
   ```

   Database ID 就是中間那一串 32 位數的代碼：

   ```
   2e62059200d88010830efb67104f032e
   ```

3. **複製 Database ID：**

   - 選取並複製這 32 位數的代碼
   - 儲存到記事本

4. **授予 Integration 存取權限：**
   - 在 Notion 資料庫頁面右上角，點擊 **「•••」**（三個點）
   - 選擇 **「Connections」** 或 **「連結」**
   - 搜尋並選擇剛才創建的 **「AutoScan」** Integration
   - 點擊 **「Confirm」**（確認）

### 步驟 4.4：填寫配置檔案

現在將所有 API Key 填入配置檔案。

1. **開啟配置檔案：**

   - 進入 `AutoScan` 資料夾
   - 找到 `config.js` 檔案
   - 在檔案上按右鍵，選擇 **「以記事本開啟」** 或使用任何文字編輯器

2. **填入 API Keys：**

找到以下內容並替換成您的資料：

```javascript
window.AUTOSCAN_CONFIG = {
  gemini: {
    apiKey: "在這裡貼上您的 Gemini API Key",
    agents: [
      {
        name: "Gemini AutoScan Agent(模擬)",
        agentKey: "gemini-3-flash-preview",
      },
    ],
  },
  openai: {
    agentName: "OpenAI AutoScan Agent(模擬)",
    apiKey: "在這裡貼上您的 OpenAI API Key（如果有）",
    assistantId: "保持原值或填入您的 Assistant ID",
  },
  notion: {
    agentName: "Notion Sync Bot",
    token: "在這裡貼上您的 Notion Token",
    databaseId: "在這裡貼上您的 Notion Database ID",
    titlePropertyName: "Name",
  },
};
```

3. **填寫範例說明：**

**Gemini API Key：**

- 格式：以 `AIzaSy` 開頭，後面接 32 位英數字
- 範例：`AIzaSyA1b2C3d4E5f6G7h8I9j0K1l2M3n4O5p6Q`（請替換成您的實際 Key）

**OpenAI API Key：**

- 格式：以 `sk-proj-` 或 `sk-` 開頭
- 範例：`sk-proj-AbCdEf123456...`（請替換成您的實際 Key）

**Notion Token：**

- 格式：以 `secret_` 或 `ntn_` 開頭
- 範例：`secret_a1b2c3d4e5f6...` 或 `ntn_123456789abcdef...`（請替換成您的實際 Token）

**Notion Database ID：**

- 格式：32 位英數字（不含連字號）
- 範例：`1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p`（請替換成您的實際 Database ID）

> [!CAUTION] > **安全提醒：**
>
> - 以上範例僅為格式說明，請勿直接使用
> - 請使用您自己申請的真實 API Key
> - 切勿將包含真實 API Key 的配置檔案分享給他人或上傳到公開位置

4. **儲存檔案：**
   - 按 **`Ctrl + S`** 儲存
   - 關閉文字編輯器

> [!IMPORTANT] > **檢查清單：**
>
> - ✅ 所有引號 `"` 都保持完整
> - ✅ 所有逗號 `,` 都保留
> - ✅ 沒有多餘的空格或換行
> - ✅ API Key 完整複製（沒有少字元）

---

## 5. 啟動程式

### 步驟 5.1：啟動伺服器

1. **開啟命令提示字元：**

   - 在 AutoScan 資料夾的網址列輸入 `cmd` 並按 Enter

2. **啟動程式：**

   ```
   npm start
   ```

3. **確認啟動成功：**

   您應該會看到以下訊息：

   ```
   🚀 AutoScan Server is running!
   ----------------------------------
   🔗 URL: http://localhost:3000
   📁 Dir: C:\Users\...\AutoScan
   ----------------------------------
   Waiting for connections...
   ```

   > [!TIP]
   > 看到這個訊息表示啟動成功！**不要關閉這個黑色視窗**，程式需要持續運行。

### 步驟 5.2：開啟瀏覽器

1. **開啟瀏覽器** (Chrome、Edge、Firefox 都可以)

2. **前往程式網址：**

   ```
   http://localhost:3000
   ```

3. **確認頁面載入：**
   - 您應該會看到 AutoScan 的操作介面
   - 有深色星空背景
   - 標題：「文件重點分析系統 | AutoScan」

---

## 6. 開始使用

### 🎯 基本操作流程

1. **選擇輸入方式：**

   - **上傳文件檔案**：支援 TXT、Word (.docx)、PDF
   - **貼上逐字稿文字**：直接貼上文字內容

2. **選擇語言：**

   - 預設為「繁體中文」
   - 可切換為其他語言

3. **選擇 AI 模型：**

   - **Gemini**：Google 的 AI 模型（推薦）
   - **OpenAI**：OpenAI 的 GPT 模型

4. **選擇 Agent：**

   - **Gemini AutoScan Agent (模擬)**：結構化輸出，適合上傳到 Notion
   - **OpenAI AutoScan Agent (模擬)**：結構化輸出

5. **分析文字：**

   - 點擊 **「🔍 分析文字」** 按鈕
   - 等待 AI 分析完成（通常需要 10-30 秒）

6. **查看結果：**

   - 分析完成後會顯示多個欄位的表單
   - 包含：ToDo、歸屬分類、專案、負責人、到期日等

7. **上傳到 Notion：**
   - 確認內容無誤後
   - 點擊 **「📤 上傳至 Notion」** 按鈕
   - 系統會自動將所有項目上傳到您的 Notion 資料庫

### 📝 使用範例

**情境：分析會議記錄**

1. 上傳會議記錄 PDF 檔案
2. 選擇「Gemini」+ 「Gemini AutoScan Agent (模擬)」
3. 點擊「分析文字」
4. AI 會自動提取：
   - 待辦事項（ToDo）
   - 分類（例如：產品開發、市場分析）
   - 專案名稱
   - 負責人
   - 到期日
   - 關鍵字
5. 檢查並編輯內容（可直接在表單中修改）
6. 點擊「上傳至 Notion」
7. 完成！所有項目會出現在您的 Notion 資料庫中

---

## 7. 常見問題排解

### ❌ 問題 1：「找不到 node」或「npm 不是內部或外部命令」

**原因：** Node.js 未正確安裝或未加入環境變數

**解決方法：**

1. 重新安裝 Node.js（參考步驟 3.1）
2. 安裝時確保勾選 **「Add to PATH」** 選項
3. 重新啟動電腦後再試

---

### ❌ 問題 2：「API key expired」或「未設定 API 金鑰」

**原因：** API Key 未正確填入或已過期

**解決方法：**

1. 檢查 `config.js` 檔案中的 API Key 是否完整
2. 確認 API Key 沒有包含多餘的空格
3. 如果 API Key 過期，重新生成新的 Key

---

### ❌ 問題 3：「Request too large」或「檔案太大」

**原因：** 上傳的檔案超過限制

**解決方法：**

1. 目前支援最大 100MB 的檔案
2. 如果檔案過大，可以：
   - 分割成較小的部分
   - 或使用較小的模型（gpt-4o-mini）

---

### ❌ 問題 4：上傳到 Notion 失敗

**原因：** Notion Integration 未正確設定或資料庫 ID 錯誤

**解決方法：**

1. 確認已在 Notion 資料庫中連結 AutoScan Integration
2. 檢查 Database ID 是否正確（32 位數）
3. 確認 Notion Token 正確無誤

---

### ❌ 問題 5：分析結果是亂碼或格式錯誤

**原因：** 語言設定不正確或 AI 模型回傳格式異常

**解決方法：**

1. 確認選擇正確的語言（繁體中文）
2. 選擇「AutoScan Agent」模式
3. 重新整理頁面後再試一次（按 F5）

---

## 📞 需要協助？

如果遇到其他問題，請聯絡技術支援人員，並提供：

1. **錯誤訊息截圖**（如果有）
2. **瀏覽器 Console 的錯誤訊息**（按 F12 開啟）
3. **您的作業系統版本**（Windows 10/11）
4. **使用的瀏覽器**（Chrome/Edge/Firefox）

---

## ✅ 安裝完成檢查清單

安裝完成後，請確認以下項目：

- [ ] Node.js 已安裝且版本正確
- [ ] 程式相依套件已安裝完成（`npm install` 成功）
- [ ] `config.js` 已填入所有必要的 API Keys
- [ ] 伺服器可正常啟動（`npm start` 無錯誤）
- [ ] 瀏覽器可開啟 http://localhost:3000
- [ ] Gemini 分析功能正常運作
- [ ] Notion 上傳功能正常運作

**全部打勾即表示安裝成功！** 🎉

---

## 📚 附錄

### A. 如何停止程式

1. 在命令提示字元視窗按 **`Ctrl + C`**
2. 出現提示時輸入 **`Y`** 並按 Enter
3. 關閉命令提示字元視窗

### B. 如何重新啟動程式

1. 開啟命令提示字元
2. 進入 AutoScan 資料夾
3. 執行 `npm start`

### C. 如何更新程式

1. 停止正在運行的程式
2. 從 GitHub 下載最新版本
3. 解壓縮並覆蓋舊檔案
4. **保留**您的 `config.js` 檔案（備份後再覆蓋）
5. 重新啟動程式

---

**版本：** 1.0 (2026-01-15)  
**適用分支：** autoscan-Ruby-UAT-20260115
